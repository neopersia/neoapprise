(function(){var $Apprise=null,$overlay=null,$body=null,$window=null,$cA=null,AppriseQueue=[];$(function(){$Apprise=$('<div class="apprise panel">');$overlay=$('<div class="apprise-overlay">');$body=$('body');$window=$(window);$body.append($overlay).append($Apprise);$overlay.on('click',function(){Apprise('close');})});Apprise=function(text,options){if(text===undefined||!text){return false;}
var $me=this,$_inner=$('<div>'),$_buttons=$('<div class="panel-footer">'),$_input=$('<input type="text">');var settings={animation:200,title:'',buttons:{confirm:{action:function(){$me.dissapear();},className:null,id:'confirm',text:'OK'}},input:false};$.extend(settings,options);if(text=='close'){$cA.dissapear();return;}
if($Apprise.is(':visible')){AppriseQueue.push({text:text,options:settings});return;}
this.dissapear=function(){$Apprise.animate({},settings.animation,function(){$overlay.fadeOut(settings.animation);$Apprise.hide();$window.unbind("beforeunload");$window.unbind("keydown");if(AppriseQueue[0]){Apprise(AppriseQueue[0].text,AppriseQueue[0].options);AppriseQueue.splice(0,1);}});};$window.on('keydown',function(e){e.preventDefault();if(e.keyCode===27){if(settings.buttons.cancel)
$("#apprise-btn-cancel").trigger('click');else
$me.dissapear();}else if(e.keyCode===13){if(settings.buttons.confirm)
$("#apprise-btn-confirm").trigger('click');else
$me.dissapear();}});$.each(settings.buttons,function(i,button){if(button){var $_button=$('<button id="apprise-btn-'+i+'" class="btn">').append(button.text);if(button.className)
$_button.addClass(button.className);$_buttons.append($_button);$_button.on("click",function(){var response={clicked:button,input:($_input.val()?$_input.val():null)};button.action(response);});}});$Apprise.html('').append(settings.title?'<div class="panel-heading">'+settings.title+'</div>':'').append($_inner.append('<div class="apprise-content">'+text+'</div>')).append($_buttons);$cA=this;if(settings.input)
$_inner.find('.apprise-content').append($('<div class="apprise-input">').append($_input));$overlay.fadeIn(settings.animation);$Apprise.show();if(settings.input)
$_input.focus();}}());